
# 1.9.3 Vue.js 3.x发布流程

>
- 1. 熟悉 vuejs 发布流程
- 2. 学会调试 nodejs 代码
- 3. 动手优化公司项目发布流程

## 1.发布流程
![image](https://user-images.githubusercontent.com/17672815/130182307-cef87963-3324-49a4-b863-ec68df2d0edc.png)


## 2. 环境准备
>打开 vue-next，  
开源项目一般都能在 README.md 或者 .github/contributing.md 找到贡献指南。  
而贡献指南写了很多关于参与项目开发的信息。比如怎么跑起来，项目目录结构是怎样的。怎么投入开发，需要哪些知识储备等。  
你需要确保 Node.js 版本是 10+, 而且 yarn 的版本是 1.x Yarn 1.x。  

```
vue-next/package.json 文件。
// vue-next/package.json
{
    "private": true,
    "version": "3.2.4",
    "workspaces": [
        "packages/*"
    ],
    "scripts": {
        // --dry 参数是我加的，如果你是调试 代码也建议加
        // 不执行测试和编译 、不执行 推送git等操作
        // 也就是说空跑，只是打印，后文再详细讲述
        "release": "node scripts/release.js --dry",
        "preinstall": "node ./scripts/checkYarn.js",
    }
}

如果你尝试使用 npm 安装依赖，应该是会报错的。为啥会报错呢。
因为 package.json 有个前置 preinstall  node ./scripts/checkYarn.js 判断强制要求是使用yarn安装。
scripts/checkYarn.js文件如下，也就是在process.env环境变量中找执行路径npm_execpath，如果不是yarn就输出警告，且进程结束。
```
- 调试 vue-next/scripts/release.js 文件
>找到 vue-next/package.json 文件打开，然后在 scripts 上方，会有debug（调试）按钮，点击后，选择 release。即可进入调试模式。


## 文件开头的一些依赖引入和函数声明
```
// vue-next/scripts/release.js
const args = require('minimist')(process.argv.slice(2))
// 文件模块
const fs = require('fs')
// 路径
const path = require('path')
// 控制台
const chalk = require('chalk')
const semver = require('semver')
const currentVersion = require('../package.json').version
const { prompt } = require('enquirer')

// 执行子进程命令   简单说 就是在终端命令行执行 命令
const execa = require('execa')
```




## 参考
- [Vue 3.2 发布了，那尤雨溪是怎么发布 Vue.js 的](https://juejin.cn/post/6997943192851054606)







