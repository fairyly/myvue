# 1.7.2 Vue3 组合式 API

## 基本范例

```
<template>
  <button @click="increment">
    Count is: {{ state.count }}, double is: {{ state.double }}
  </button>
</template>

<script>
  import { reactive, computed } from 'vue'

  export default {
    setup() {
      const state = reactive({
        count: 0,
        double: computed(() => state.count * 2),
      })

      function increment() {
        state.count++
      }

      return {
        state,
        increment,
      }
    },
  }
</script>
```

## setup
setup 函数是一个新的组件选项。作为在组件内使用 Composition API 的入口点


- 调用时机:

>创建组件实例，然后初始化 props ，紧接着就调用setup 函数。从生命周期钩子的视角来看，它会在 beforeCreate 钩子之前被调用

- 模板中使用

>如果 setup 返回一个对象，则对象的属性将会被合并到组件模板的渲染上下文:

>注意 setup 返回的 ref 在模板中会自动解开，不需要写 `.value`

- 渲染函数 / JSX 中使用

>setup 也可以返回一个函数，函数中也能使用当前 setup 函数作用域中的响应式数据：

```
import { h, ref, reactive } from 'vue'

export default {
  setup() {
    const count = ref(0)
    const object = reactive({ foo: 'bar' })

    return () => h('div', [count.value, object.foo])
  },
}
```

## 参考
- [API 手册](https://vue-composition-api-rfc.netlify.app/zh/api.html)
- [Vue3.0 源码解读](https://hkc452.github.io/slamdunk-the-vue3/)
- [组合式 API 征求意见稿](https://vue-composition-api-rfc.netlify.app/zh/#%E6%A6%82%E8%BF%B0)
