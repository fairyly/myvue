# 3.1.8 根据 nuxt 基础框架配置项目

## 配置 axios
>把 axios 当插件使用

- 1.`nuxt.config.js ` 配置
```
  /*
   ** Plugins to load before mounting the App
   */
  plugins: ['@/plugins/antd-ui', '~/plugins/axios'],

  /*
   ** Nuxt.js modules
   */
  modules: [
    // Doc: https://axios.nuxtjs.org/usage
    '@nuxtjs/axios',
    '@nuxtjs/pwa'
  ],
  /*
   ** Axios module configuration
   */
  axios: {
    baseURL: 'https://cnodejs.org/api/v1',
    // See https://github.com/nuxt-community/axios-module#options
  },
```

- 2. 新建 `plugins/axios.js` 文件

```
function handleError (error, app, store, redirect, route) {
  if (error.response.status) {
    switch (error.response.status) {
      case 401:
        redirect(`/signin?from=${route.fullPath}`)
        break
      case 403:
        app.$toast.error('登录过期，请重新登录')
        store.commit('SET_STATE', { user: null })
        setTimeout(_ => {
          redirect(`/signin?from=${route.fullPath}`)
        }, 1000)
        break
      case 404:
        app.$toast.error('网络请求不存在')
        break
      default:
        app.$toast.error(error.response.data.error_msg)
    }
    return Promise.reject(error.response)
  }
}

export default function ({ $axios, app, store, redirect, route }) {
  $axios.onRequest(
    config => {
      console.log('Making request to ' + config.url)
      return config
    },
    error => {
      return Promise.reject(error)
    }
  )

  $axios.onResponse(
    response => {
      if (response.status === 200) {
        return Promise.resolve(response)
      } else {
        return Promise.reject(response)
      }
    },
    error => handleError(error, app, store, redirect, route)
  )

  $axios.onError(error => handleError(error, app, store, redirect, route))
}
```



## 参考
- []()
